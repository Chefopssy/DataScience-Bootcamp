CREATE DATABASE CHECKPOINT_6B;
USE CHECKPOINT_6B;

CREATE TABLE WINE (
		WINE_ID INT PRIMARY KEY NOT NULL,
		NUMW INT NOT NULL,
		CATERGORY VARCHAR (50) NOT NULL,
		QUANTITY DECIMAL (10, 02) CHECK (QUANTITY > 0) NOT NULL, 
		WINE_YEAR DATE NOT NULL, 
		DEGREE DECIMAL (20, 02) NOT NULL,);

CREATE TABLE PRODUCERS (
		PRODUCER_ID INT PRIMARY KEY NOT NULL, 
		NUMP INT NOT NULL, 
		FIRSTNAME VARCHAR (20) NOT NULL,
		LASTNAME VARCHAR (20) NOT NULL,
		REGION VARCHAR (25) NOT NULL);


CREATE TABLE HARVEST (
		HARVEST_ID INT PRIMARY KEY NOT NULL,
		WINE_ID INT NOT NULL, 
		PRODUCER_ID INT NOT NULL,
		QUANTITY DECIMAL (10, 02) CHECK (QUANTITY > 0) NOT NULL,
		FOREIGN KEY (WINE_ID) REFERENCES WINE (WINE_ID), 
		FOREIGN KEY (PRODUCER_ID) REFERENCES PRODUCER (PRODUCER_ID))

INSERT INTO WINE (WINE_ID, NUMW, CATEGORY, QUANTITY, WINE_YEAR, DEGREE)
VALUES (1, 1, 'ROSE', 120, '1987', 10),													
		(2, 2, 'CHARDONNAY', 132, '1997', 12),
		(3, 3, 'Red wine', 110, '1999', 18),
		(4, 4, 'Merlot', 121, '2002', 20.0),
		(5, 5, 'SAUVIGNON BLANC', 139, '2003', 19.2),
		(6, 6, 'SPARKLING WINE', 142, '1995', 0),
		(7, 7, 'Sangiovese', 300, '1997', 12),
		(8, 8, 'Tempranillo', 50, '2002', 50),
		(9, 9, 'GRAPE WINE', 12, '2005', 20),
		(10, 10, 'FRUIT WINE', 500, '2010', 10),
		(11, 11, 'DESSERT WINE', 420, '1995', 25),
		(12, 12, 'ICE WINE', 120, '1987', 38),
		(13, 13, 'WHITE WINE', 250, '1976', 40),
		(14, 14, 'OGOGORO', 300, '1985', 50),
		(15, 15, 'CAVA', 89, '2001', 29),
		(16, 16, 'SPANISH WINE', 100, '1995', 25),
		(17, 17, 'CHARDONNAY', 201, '1999', 21),
		(18, 18, 'PINOT NOIR', 32, '2003', 32.5),
		(19, 19, 'BARON', 750, '2000', 18.5),				
		(20, 20, 'FOUR COUSINS', 750, '2000', 20),
		(21, 21, 'CHAMPAGNE', 250, '2002', 45),
		(22, 22, 'MIMOSA', 100, '2005', 21),
		(23, 23, 'GRAPE WINE', 200, '2004', 23),
		(24, 24, 'ORIGIN', 400, '2010', 40),
		(25, 25, 'ODOGWU BITTERS', 400, '2020', 50),
		(26, 26, 'ALOMO BITTERS', 450, '2003' 20), 
		(27, 27, 'CHELSEA', 750, '2000', 30),
		(28, 28, 'EVA', 750, '2020', 10),
		(29, 29, 'BARON', 850, '2001', 20),
		(30, 30, 'WHISKEY', 300, '2006', 97);
			   
INSERT INTO PRODUCERS (PRODUCER_ID, NUMP, FIRSTNAME, LASTNAME, REGION)
VALUES	(1, 1, 'OPEMIPO', 'AJIFOLA', 'SOUSSE'),
		(2, 2, 'MONISADE', 'AJIFOLA', 'SENEGAL'),
		(3, 3, 'OLUWASEUN', 'OWONIKOKO', 'OGUN'),
		(4, 4, 'AJANLEKOKO', 'LAGBAJA', 'DUBLIN'),
		(5, 5, 'SIMI', 'AJIX', 'MAGODO'), 
		(6, 6, 'BUNMI', 'AYO', 'AMERICA'),
		(7, 7, 'BROWN', 'SETH', 'PARIS'),
		(8, 8, 'DAN', 'RAUL', 'ABEOKUTA'),
		(9, 9, 'DRAKE', 'EMIMEM', 'MEXICO'),
		(10, 10, 'MICHEAL', 'JACKSON', 'OSHODI'),
		(11, 11, 'FAITH', 'ESTHER', 'MARYLAND'),
		(12, 12, 'ADEBODUN', 'KAREEM', 'GHANA'),
		(13, 13, 'DAVID', 'ADELEKE', 'IKOYI'),
		(14, 14, 'BRYMO', '9CE', 'LEKKI'),
		(15, 15, 'TUFACE', 'IDIBIA', 'BANANA ISLAND'),
		(16, 16, 'MARY', 'JANE', 'PALMWINE EXPRESS'),
		(17, 17, 'MANLIKEPAULO', 'AGBASCAMMER', 'IKORODU'),
		(18, 18, 'ASHADE', 'ABIOLA', 'DUBLIN'),
		(19, 19, 'BARRY', 'ALLEN', 'ZIMBABWE'),
		(20, 20, 'CLAUS', 'MICHEALSON', 'NEW ORLEANS'),
		(21, 21, 'REBECCA', 'MICHEALSON', 'NEW ORLEANS'),
		(22, 22, 'ELIJAH', 'MICHEALSON', 'NEW ORLEANS'),
		(23, 23, 'JAMES', 'ST.PATRICK', 'NEW YORK'), 
		(24, 24, 'TASHA', 'ST.PATRICK', 'NEW YORK'),
		(25, 25, 'CHRIS', 'ST.PATRICK', 'NEW YORK'),
		(26, 26, 'KATE', 'ST.PATRICK', 'NEW YORK'),
		(27, 27, 'DAMI', 'BELLO', 'KETU'),
		(28, 28, 'WATCHMAN', 'THEMAINGUY', 'ALLEN'),
		(29, 29, 'LAURA', 'AREWA', 'IKOYI'),
		(30, 30, 'ELLA', 'NANCY', 'IPAJA');

INSERT INTO HARVEST (HARVEST_ID, WINE_ID, PRODUCER_ID, QUANTITY)
VALUES (1, 1, 1, 120),
		(2, 2, 2, 132),
		(3, 3, 3, 110),
		(4, 4, 4, 121),
		(5, 5, 5, 139),
		(6, 6, 6, 142),
		(7, 7, 7, 300),
		(8, 8, 8, 50),
		(9, 9, 9, 12),
		(10, 10, 10, 500),
		(11, 11, 11, 420),
		(12, 12, 12, 120),
		(13, 13, 13, 250),
		(14, 14, 14, 300),
		(15, 15, 15, 89),
		(16, 16, 16, 100),
		(17, 17, 17, 201),
		(18, 18, 18, 32),
		(19, 19, 19, 750),
		(20, 20, 20, 750),
		(21, 21, 21, 250),
		(22, 22, 22, 100),
		(23, 23, 23, 200),
		(24, 24, 24, 400),
		(25, 25, 25, 400),
		(26, 26, 26, 450),
		(27, 27, 27, 750),
		(28, 28, 28, 750),
		(29, 29, 29, 850),
		(30, 30, 30, 300); 


--4. LIST OF PRODUCERS
SELECT * FROM PRODUCERS

--5. LIST OF PRODUCERS SORTED BY NAMES
SELECT * FROM PRODUCERS 
ORDER BY (FIRSTNAME), (LASTNAME);

--6. LIST OF PRODUCERS OF SOUSSE
SELECT * FROM PRODUCERS
WHERE REGION = 'SOUSSE';


--7 TOTAL QUANTITY OF WINE PRODUCED HAVING NUMBER 12
SELECT 
SUM (WINE.QUANTITY) AS TOTAL_QUANTITY_PRODUCED
FROM WINE
WHERE WINE_ID = 12
GROUP BY WINE_ID;


--8. QUANTITY OF WINE PRODUCED BY CATERGORY 
SELECT CATEGORY, SUM(WINE.QUANTITY) AS TOTAL_QUANTITY_PRODUCED
FROM WINE
GROUP BY WINE.CATERGORY;


--9. LIST OF PRODUCERS IN SOUSSE, HARVESTED AT LEAST ONE WINE > 300 LITERS
SELECT FIRSTNAME, LASTNAME
FROM PRODUCERS
INNER JOIN HARVEST ON PRODUCERS.PRODUCER_ID =  HARVEST.PRODUCER_ID
WHERE PRODUCERS.REGION = 'SOUSSE' AND HARVEST.QUANTITY >= 300
ORDER BY FIRSTNAME, LASTNAME DESC;


--10 WINE NUMBERS A DEGREE > 12 AND HAVE BEEN PRODUCED BY PRODUCER NUMBER 24
SELECT HARVEST.HARVEST_ID, WINE.NUMW, WINE.DEGREE, PRODUCERS.PRODUCER_ID, PRODUCERS.FIRSTNAME, PRODUCERS.LASTNAME,
HARVEST.QUANTITY
FROM HARVEST
INNER JOIN WINE 
ON HARVEST.WINE_ID = WINE.WINE_ID
INNER JOIN PRODUCERS
ON HARVEST.PRODUCER_ID = PRODUCERS.PRODUCER_ID

SELECT HARVEST.HARVEST_ID, WINE.NUMW, WINE.DEGREE,
PRODUCERS.PRODUCER_ID, PRODUCERS.FIRSTNAME, PRODUCERS.LASTNAME,
HARVEST.QUANTITY FROM HARVEST
INNER JOIN WINE 
ON HARVEST.WINE_ID = WINE.WINE_ID
INNER JOIN PRODUCERS 
HARVEST.PRODUCER_ID = PRODUCERS.PROCUDER_ID
WHERE WINE.DEGREE >12 AND PRODUCERS.PRODUCER_ID = 24